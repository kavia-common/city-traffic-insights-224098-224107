{"is_source_file": true, "format": "JavaScript", "description": "This file defines a JavaScript module that interacts with the TomTom Traffic Flow API to fetch live traffic data for specified city coordinates. It processes the API response to create a normalized data structure, inferring congestion levels and approximating density, and attempts to persist this data into a MongoDB collection. The module primarily facilitates real-time, city-specific traffic data retrieval and normalization.", "external_files": ["../logger", "../models/TrafficRecord"], "external_methods": ["logger.warn", "logger.error", "TrafficRecord.insertMany"], "published": ["fetchRealTimeCity", "CITY_COORDS"], "classes": [], "methods": [{"name": "inferCongestionLevel(relativeSpeed, currentSpeed)", "description": "Calculates congestion level based on relativeSpeed and currentSpeed, returning a normalized value between 0 and 1.", "scope": "", "scopeKind": ""}, {"name": "buildSegmentId(city, frc, speed)", "description": "Creates a unique segment identifier string using city, road class, and speed.", "scope": "", "scopeKind": ""}, {"name": "fetchRealTimeCity(city)", "description": "Fetches live traffic data for a specified city from TomTom API, processes and normalizes the response, and attempts to store it in MongoDB.", "scope": "", "scopeKind": ""}], "calls": ["fetch", "logger.warn", "logger.error", "TrafficRecord.insertMany"], "search-terms": ["realTrafficService", "TomTom Traffic Flow API", "city traffic data", "normalize traffic data", "MongoDB traffic record", "city coordinates traffic", "fetchCityTraffic"], "state": 2, "file_id": 22, "knowledge_revision": 94, "git_revision": "1d46c49ef9f3a71e66efe8c6a934124c28fd00e7", "revision_history": [{"65": ""}, {"73": "5f4807e06d3b43b6d2b14cbd65a9a2afb01e017e"}, {"94": "1d46c49ef9f3a71e66efe8c6a934124c28fd00e7"}], "ctags": [{"_type": "tag", "name": "Bangalore", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Bangalore: { lat: 12.9716, lng: 77.5946 },$/", "language": "JavaScript", "kind": "class", "scope": "CITY_COORDS", "scopeKind": "class"}, {"_type": "tag", "name": "CITY_COORDS", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^const CITY_COORDS = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "Delhi", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Delhi: { lat: 28.6139, lng: 77.2090 },$/", "language": "JavaScript", "kind": "class", "scope": "CITY_COORDS", "scopeKind": "class"}, {"_type": "tag", "name": "Mumbai", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Mumbai: { lat: 19.0760, lng: 72.8777 },$/", "language": "JavaScript", "kind": "class", "scope": "CITY_COORDS", "scopeKind": "class"}, {"_type": "tag", "name": "TOMTOM_BASE", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^const TOMTOM_BASE = 'https:\\/\\/api.tomtom.com\\/traffic\\/services\\/4\\/flowSegmentData\\/relative0\\//", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "TrafficRecord", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^const TrafficRecord = require('..\\/models\\/TrafficRecord');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildSegmentId", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^function buildSegmentId(city, frc, speed) {$/", "language": "JavaScript", "kind": "function", "signature": "(city, frc, speed)"}, {"_type": "tag", "name": "city", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    city,$/", "language": "JavaScript", "kind": "field", "scope": "fetchRealTimeCity.snapshot", "scopeKind": "class"}, {"_type": "tag", "name": "coordinates", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    coordinates: line,$/", "language": "JavaScript", "kind": "property", "scope": "fetchRealTimeCity.feature", "scopeKind": "class"}, {"_type": "tag", "name": "densityVpkm", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    densityVpkm,$/", "language": "JavaScript", "kind": "field", "scope": "fetchRealTimeCity.feature", "scopeKind": "class"}, {"_type": "tag", "name": "feature", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  const feature = {$/", "language": "JavaScript", "kind": "class", "scope": "fetchRealTimeCity", "scopeKind": "class"}, {"_type": "tag", "name": "fetchRealTimeCity", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  fetchRealTimeCity,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "fetchRealTimeCity", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^async function fetchRealTimeCity(city) {$/", "language": "JavaScript", "kind": "function", "signature": "(city)"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    id: buildSegmentId(city, seg.frc, currentSpeed),$/", "language": "JavaScript", "kind": "property", "scope": "fetchRealTimeCity.feature", "scopeKind": "class"}, {"_type": "tag", "name": "inferCongestionLevel", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^function inferCongestionLevel(relativeSpeed, currentSpeed) {$/", "language": "JavaScript", "kind": "function", "signature": "(relativeSpeed, currentSpeed)"}, {"_type": "tag", "name": "lat", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Bangalore: { lat: 12.9716, lng: 77.5946 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Bangalore", "scopeKind": "class"}, {"_type": "tag", "name": "lat", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Delhi: { lat: 28.6139, lng: 77.2090 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Delhi", "scopeKind": "class"}, {"_type": "tag", "name": "lat", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Mumbai: { lat: 19.0760, lng: 72.8777 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Mumbai", "scopeKind": "class"}, {"_type": "tag", "name": "lng", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Bangalore: { lat: 12.9716, lng: 77.5946 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Bangalore", "scopeKind": "class"}, {"_type": "tag", "name": "lng", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Delhi: { lat: 28.6139, lng: 77.2090 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Delhi", "scopeKind": "class"}, {"_type": "tag", "name": "lng", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Mumbai: { lat: 19.0760, lng: 72.8777 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Mumbai", "scopeKind": "class"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^const logger = require('..\\/logger');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "speedKph", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    speedKph: Number.isFinite(currentSpeed) ? Number(currentSpeed.toFixed(2)) : null,$/", "language": "JavaScript", "kind": "property", "scope": "fetchRealTimeCity.feature", "scopeKind": "class"}], "hash": "ac9e2b98ce2d786ec2597505224ff4a4", "format-version": 4, "code-base-name": "traffic_backend", "filename": "traffic_backend/src/services/realTrafficService.js", "fields": [{"name": "city,", "scope": "fetchRealTimeCity.snapshot", "scopeKind": "class", "description": "unavailable"}, {"name": "coordinates: line,", "scope": "fetchRealTimeCity.feature", "scopeKind": "class", "description": "unavailable"}, {"name": "densityVpkm,", "scope": "fetchRealTimeCity.feature", "scopeKind": "class", "description": "unavailable"}, {"name": "fetchRealTimeCity,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "id: buildSegmentId(city, seg.frc, currentSpeed),", "scope": "fetchRealTimeCity.feature", "scopeKind": "class", "description": "unavailable"}, {"name": "Bangalore: { lat: 12.9716, lng: 77.5946 },", "scope": "CITY_COORDS.Bangalore", "scopeKind": "class", "description": "unavailable"}, {"name": "Delhi: { lat: 28.6139, lng: 77.2090 },", "scope": "CITY_COORDS.Delhi", "scopeKind": "class", "description": "unavailable"}, {"name": "Mumbai: { lat: 19.0760, lng: 72.8777 },", "scope": "CITY_COORDS.Mumbai", "scopeKind": "class", "description": "unavailable"}, {"name": "speedKph: Number.isFinite(currentSpeed) ? Number(currentSpeed.toFixed(2)) : null,", "scope": "fetchRealTimeCity.feature", "scopeKind": "class", "description": "unavailable"}]}