{"is_source_file": true, "format": "JavaScript", "description": "This source file `realTrafficService.js` provides functions to fetch real-time traffic data from the TomTom Traffic Flow API for specific city coordinates. It processes and normalizes the API response, estimates congestion levels, and stores the data into a MongoDB collection through the TrafficRecord model. The main exported function is `fetchRealTimeCity`, which retrieves and processes data for a given city, supporting integration with a traffic insights system.", "external_files": ["../logger", "../models/TrafficRecord"], "external_methods": ["logger.warn", "logger.error", "TrafficRecord.insertMany"], "published": ["fetchRealTimeCity", "CITY_COORDS"], "classes": [], "methods": [{"name": "inferCongestionLevel(relativeSpeed, currentSpeed)", "description": "Determines congestion level based on relative speed and current speed, returning a value between 0 and 1.", "scope": "", "scopeKind": ""}, {"name": "buildSegmentId(city, frc, speed)", "description": "Constructs a synthetic segment identifier based on city, functional road class, and speed.", "scope": "", "scopeKind": ""}, {"name": "fetchRealTimeCity(city)", "description": "Fetches real-time traffic data for a specified city from TomTom API, processes it, and stores a normalized snapshot.", "scope": "", "scopeKind": ""}], "calls": ["fetch", "logger.warn", "logger.error", "TrafficRecord.insertMany"], "search-terms": ["TomTom Traffic API", "fetchRealTimeCity", "TrafficRecord", "city-traffic-insights", "realTrafficService", "traffic API integration"], "state": 2, "file_id": 22, "knowledge_revision": 65, "git_revision": "", "ctags": [{"_type": "tag", "name": "Bangalore", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Bangalore: { lat: 12.9716, lng: 77.5946 },$/", "language": "JavaScript", "kind": "class", "scope": "CITY_COORDS", "scopeKind": "class"}, {"_type": "tag", "name": "CITY_COORDS", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^const CITY_COORDS = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "Delhi", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Delhi: { lat: 28.6139, lng: 77.2090 },$/", "language": "JavaScript", "kind": "class", "scope": "CITY_COORDS", "scopeKind": "class"}, {"_type": "tag", "name": "Mumbai", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Mumbai: { lat: 19.0760, lng: 72.8777 },$/", "language": "JavaScript", "kind": "class", "scope": "CITY_COORDS", "scopeKind": "class"}, {"_type": "tag", "name": "TOMTOM_BASE", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^const TOMTOM_BASE = 'https:\\/\\/api.tomtom.com\\/traffic\\/services\\/4\\/flowSegmentData\\/relative0\\//", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "TrafficRecord", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^const TrafficRecord = require('..\\/models\\/TrafficRecord');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildSegmentId", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^function buildSegmentId(city, frc, speed) {$/", "language": "JavaScript", "kind": "function", "signature": "(city, frc, speed)"}, {"_type": "tag", "name": "city", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    city,$/", "language": "JavaScript", "kind": "field", "scope": "fetchRealTimeCity.snapshot", "scopeKind": "class"}, {"_type": "tag", "name": "coordinates", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    coordinates: line,$/", "language": "JavaScript", "kind": "property", "scope": "fetchRealTimeCity.feature", "scopeKind": "class"}, {"_type": "tag", "name": "densityVpkm", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    densityVpkm,$/", "language": "JavaScript", "kind": "field", "scope": "fetchRealTimeCity.feature", "scopeKind": "class"}, {"_type": "tag", "name": "feature", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  const feature = {$/", "language": "JavaScript", "kind": "class", "scope": "fetchRealTimeCity", "scopeKind": "class"}, {"_type": "tag", "name": "fetchRealTimeCity", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  fetchRealTimeCity,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "fetchRealTimeCity", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^async function fetchRealTimeCity(city) {$/", "language": "JavaScript", "kind": "function", "signature": "(city)"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    id: buildSegmentId(city, seg.frc, currentSpeed),$/", "language": "JavaScript", "kind": "property", "scope": "fetchRealTimeCity.feature", "scopeKind": "class"}, {"_type": "tag", "name": "inferCongestionLevel", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^function inferCongestionLevel(relativeSpeed, currentSpeed) {$/", "language": "JavaScript", "kind": "function", "signature": "(relativeSpeed, currentSpeed)"}, {"_type": "tag", "name": "lat", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Bangalore: { lat: 12.9716, lng: 77.5946 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Bangalore", "scopeKind": "class"}, {"_type": "tag", "name": "lat", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Delhi: { lat: 28.6139, lng: 77.2090 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Delhi", "scopeKind": "class"}, {"_type": "tag", "name": "lat", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Mumbai: { lat: 19.0760, lng: 72.8777 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Mumbai", "scopeKind": "class"}, {"_type": "tag", "name": "lng", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Bangalore: { lat: 12.9716, lng: 77.5946 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Bangalore", "scopeKind": "class"}, {"_type": "tag", "name": "lng", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Delhi: { lat: 28.6139, lng: 77.2090 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Delhi", "scopeKind": "class"}, {"_type": "tag", "name": "lng", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^  Mumbai: { lat: 19.0760, lng: 72.8777 },$/", "language": "JavaScript", "kind": "property", "scope": "CITY_COORDS.Mumbai", "scopeKind": "class"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^const logger = require('..\\/logger');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "speedKph", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/services/realTrafficService.js", "pattern": "/^    speedKph: Number.isFinite(currentSpeed) ? Number(currentSpeed.toFixed(2)) : null,$/", "language": "JavaScript", "kind": "property", "scope": "fetchRealTimeCity.feature", "scopeKind": "class"}], "hash": "b682025df5fbd06295d68fa2753927d0", "format-version": 4, "code-base-name": "traffic_backend", "filename": "traffic_backend/src/services/realTrafficService.js", "fields": [{"name": "city,", "scope": "fetchRealTimeCity.snapshot", "scopeKind": "class", "description": "unavailable"}, {"name": "coordinates: line,", "scope": "fetchRealTimeCity.feature", "scopeKind": "class", "description": "unavailable"}, {"name": "densityVpkm,", "scope": "fetchRealTimeCity.feature", "scopeKind": "class", "description": "unavailable"}, {"name": "fetchRealTimeCity,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "id: buildSegmentId(city, seg.frc, currentSpeed),", "scope": "fetchRealTimeCity.feature", "scopeKind": "class", "description": "unavailable"}, {"name": "Bangalore: { lat: 12.9716, lng: 77.5946 },", "scope": "CITY_COORDS.Bangalore", "scopeKind": "class", "description": "unavailable"}, {"name": "Delhi: { lat: 28.6139, lng: 77.2090 },", "scope": "CITY_COORDS.Delhi", "scopeKind": "class", "description": "unavailable"}, {"name": "Mumbai: { lat: 19.0760, lng: 72.8777 },", "scope": "CITY_COORDS.Mumbai", "scopeKind": "class", "description": "unavailable"}, {"name": "speedKph: Number.isFinite(currentSpeed) ? Number(currentSpeed.toFixed(2)) : null,", "scope": "fetchRealTimeCity.feature", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"65": ""}]}