{"is_source_file": true, "format": "JavaScript", "description": "This file defines the TrafficController class, which handles API endpoints related to traffic data: live, historical, and predicted traffic. The class methods interact with services and data storage layers to retrieve, process, and respond with traffic information, including normalization and fallback mechanisms.", "external_files": ["../services/traffic", "../logger"], "external_methods": ["require('../services/traffic').store", "require('../services/traffic').getDbHistory", "require('../services/traffic').normalizeCity", "require('../services/traffic').validateCity", "require('../logger')"], "published": ["new TrafficController()"], "classes": [{"name": "TrafficController", "description": "Controller class providing endpoints for live, historical, and predicted traffic data."}], "methods": [{"name": "live(req, res)", "description": "Fetches and normalizes live traffic snapshot data for a specified city, including incident data and feature coordinates.", "scope": "TrafficController", "scopeKind": "class"}, {"name": "history(req, res)", "description": "Retrieves recent traffic history for a city, supporting time filters and format options for data presentation (raw or points for charts). Implements fallback between database and in-memory data.", "scope": "TrafficController", "scopeKind": "class"}, {"name": "predict(req, res)", "description": "Provides short-term traffic predictions based on trend analysis, allowing configuration of prediction horizon.", "scope": "TrafficController", "scopeKind": "class"}], "calls": ["require('../services/traffic').store.getLiveSnapshot", "require('../services/traffic').validateCity", "normalizeCity", "logger.debug", "logger.error", "getDbHistory", "store.getHistory", "require('../services/traffic').predictTrendBased"], "search-terms": ["TrafficController", "live traffic", "traffic history", "traffic prediction", "normalizeCity", "getDbHistory", "predictTrendBased"], "state": 2, "file_id": 16, "knowledge_revision": 113, "git_revision": "def4b561ffdc823e90a7e3d3eede931d12c7571b", "revision_history": [{"33": ""}, {"56": "fa132d5faf7b5336615e3b7aeea2bd03a3319a9f"}, {"60": "473fed1cd8852177e4e36de9af1af8d43c50bed7"}, {"67": "772af656656064da734b02a54db4e0b8e97124a2"}, {"75": "5f4807e06d3b43b6d2b14cbd65a9a2afb01e017e"}, {"80": "dc2dffba5828c7f9a27b75ef30529b82b4c4fda1"}, {"83": "dc2dffba5828c7f9a27b75ef30529b82b4c4fda1"}, {"95": "1d46c49ef9f3a71e66efe8c6a934124c28fd00e7"}, {"96": "1d46c49ef9f3a71e66efe8c6a934124c28fd00e7"}, {"97": "1d46c49ef9f3a71e66efe8c6a934124c28fd00e7"}, {"98": "1d46c49ef9f3a71e66efe8c6a934124c28fd00e7"}, {"101": "11441553a830e2eed2f539d1b4a16347e123111b"}, {"111": "def4b561ffdc823e90a7e3d3eede931d12c7571b"}, {"112": "def4b561ffdc823e90a7e3d3eede931d12c7571b"}, {"113": "def4b561ffdc823e90a7e3d3eede931d12c7571b"}], "ctags": [{"_type": "tag", "name": "TrafficController", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/controllers/traffic.js", "pattern": "/^class TrafficController {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/controllers/traffic.js", "pattern": "/^module.exports = new TrafficController();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "history", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/controllers/traffic.js", "pattern": "/^  async history(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "TrafficController", "scopeKind": "class"}, {"_type": "tag", "name": "live", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/controllers/traffic.js", "pattern": "/^  async live(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "TrafficController", "scopeKind": "class"}, {"_type": "tag", "name": "logger", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/controllers/traffic.js", "pattern": "/^const logger = require('..\\/logger');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "predict", "path": "/home/kavia/workspace/code-generation/city-traffic-insights-224098-224107/traffic_backend/src/controllers/traffic.js", "pattern": "/^  async predict(req, res) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res)", "scope": "TrafficController", "scopeKind": "class"}], "hash": "809e61447baf73712e69d5fbac9a9c65", "format-version": 4, "code-base-name": "traffic_backend", "filename": "traffic_backend/src/controllers/traffic.js", "fields": [{"name": "module.exports = new TrafficController();", "scope": "module", "scopeKind": "class", "description": "unavailable"}]}